<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id: g7ctrl.1.xml 754 2015-03-02 07:18:03Z ljp $ -->
<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbook.rng" type="xml"?>
<article
    xmlns="http://docbook.org/ns/docbook"
    xmlns:xlink="http://www.w3.org/1999/xlink"
    version="5.0">
    <title>g7ctrl</title>
    <refentry
        xml:id="g7ctrl">
        <info>
            <author>
                <personname>
                    <firstname>Johan</firstname>
                    <surname>Persson</surname>
                </personname>
                <email>johan162@gmail.com</email>
                <contrib>Main author and maintainer</contrib>
            </author>
        </info>
        <refmeta>
            <refentrytitle>g7ctrl</refentrytitle>
            <manvolnum>1</manvolnum>
            <refmiscinfo
                class="version">@VERSION@</refmiscinfo>
            <refmiscinfo
                class="source">http://sourceforge.net/projects/g7ctrl/</refmiscinfo>
            <refmiscinfo
                class="manual">http://sourceforge.net/projects/g7ctrl/docs/</refmiscinfo>
        </refmeta>
        <refnamediv>
            <refname>g7ctrl</refname>
            <refpurpose>Control daemon for a GM7 GPS Tracker</refpurpose>
        </refnamediv>
        <refsynopsisdiv
            xml:id="g7ctrl.synopsis">
            <title>Synopsis</title>
            <cmdsynopsis>
                <command>g7ctrl</command>
                <arg
                    choice="opt">options...</arg>
            </cmdsynopsis>
        </refsynopsisdiv>
        <refsect1
            xml:id="g7ctrl.description">
            <title>Description</title>
            <para>The <citerefentry>
                    <refentrytitle>g7ctrl</refentrytitle>
                    <manvolnum>1</manvolnum>
                </citerefentry> is a daemon that is used to manage a GM7 GPS tracker. The daemon has
                two main functions. One) it can receive incoming location messages on a specified
                TCP/IP port that the tracker sends and Two) It allows easy controlling of a GM7
                tracker that is connected via USB to the server. Connecting the device with USB to
                the server is the easiest way to configure the tracker. The daemon defines a command
                set that is easier for the user compared with the native GM7 tracker protocol. It
                does not require the user to memorize all commands and their arguments but rather
                asks in clear text for what settings the user wants to change.</para>
            <para>Even though it is perfectly possible to directly connect to the daemon on the
                specified command port it is recommended to use the supplied command shell <citerefentry>
                    <refentrytitle>g7sh</refentrytitle>
                    <manvolnum>1</manvolnum>
                </citerefentry>. This will offer both full command line editing as well has history
                function. In addition it hides some of the extra protocol handling on the daemon to
                make it even more user friendly.</para>
            <para>The configuration of the daemon such as what ports to listen on is controlled by
                the configuration file (by default this is found in
                    <filename>/etc/g7ctrl/g7ctrl.conf</filename>).</para>
        </refsect1>
        <refsect1
            xml:id="g7ctrl.options">
            <title>Arguments</title>
            <para>The following command line arguments are supported when starting the daemon</para>
                <variablelist>
                    <varlistentry>
                        <term><parameter>-d, --daemon [n|y]</parameter></term>
                        <listitem>
                            <para>Determine whether the server should be disconnected from the
                            controlling terminal (a.k.a. running as a daemon). If the server is run
                            as a daemon the logfile cannot be '<emphasis>stdout</emphasis>'. This
                            command line option will override the '<emphasis>daemon</emphasis>'
                            setting in the configuration file. The default setting is to run as a
                            daemon.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><parameter>-h, --help</parameter></term>
                        <listitem>
                            <para>Print help</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><parameter>-i file, --inifile=file</parameter></term>
                        <listitem>
                            <para>Use the specified file as configuration file. This will override
                                the location specified at compile time. The default location is
                                    '<filename>/etc/g7ctrl/g7ctrl.conf</filename>'</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><parameter>-l logfile, --logfile=file</parameter></term>
                        <listitem>
                            <para>Define the name of the logfile. Two special names can be used,
                                <filename>stdout</filename> which will cause the log to be written
                            to the <emphasis>stdout</emphasis> and <filename>syslog</filename> which
                            will cause the logs to be written using the default system logger. This
                            command line option will override the '<emphasis>logfile</emphasis>'
                            setting in the configuration file. The default location is
                                '<filename>/var/log/g7ctrl/g7ctrl.log</filename>'</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><parameter>-p n, --cmdport=n</parameter></term>
                        <listitem>
                            <para>Specify what TCP/IP port number that the server will listening on
                                for commands. This will override the '<emphasis>port</emphasis>'
                                setting in the ini-file. By default the command port is 3100. </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><parameter>-s n, --stty=n</parameter></term>
                        <listitem>
                            <para>Specify what <literal>ttyACM&lt;n></literal> device to use when
                                connecting over USB to device</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><parameter>-t n, --trkport=n</parameter></term>
                        <listitem>
                            <para>Specify TCP/IP port number for receiving tracker updates. This
                                will override the setting in the config file. Default port is
                                3400</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><parameter>-V n, --verbose</parameter></term>
                        <listitem>
                            <para>Log verbosity level. 0 will only log error messages, 1 will log
                                error and info messages, 2 will log errors, info and additional
                                notices finally 3 will also log (possibly) high volume debug
                                messages.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><parameter>-v, --version</parameter></term>
                        <listitem>
                            <para>Print version information and exit</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><parameter>---pidfile=file</parameter></term>
                        <listitem>
                            <para>Specify PID lock file to be used. By default this is
                                <filename>/var/run/g7ctrl/g7ctrl.pid</filename> so if the daemon is
                                not started as root it must be specified since only root has access to
                                <filename>/var/run</filename>.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><parameter>---datadir=directory</parameter></term>
                        <listitem>
                            <para>Specify directory for static data files (default,is
                                <filename>/usr/share/g7ctrl</filename>) .</para>
                        </listitem>
                    </varlistentry>                    
                    <varlistentry>
                        <term><parameter>---dbdir=directory</parameter></term>
                        <listitem>
                            <para>Specify directory for dynamic data files (default,is
                                <filename>/var/lib/g7ctrl</filename>) .</para>
                        </listitem>
                    </varlistentry>                    
                    
                </variablelist>            
            <para>The default arguments corresponds to starting the server with</para>
            <para>
                <screen>g7ctrl -i "/etc/g7ctrl/g7ctrl.conf" -d Y -s 0 -p 3100 -t 3400 \
-l "/var/log/g7ctrl/g7ctrl.log" V 2 --pidfile="/var/run/g7ctrl/g7ctrl.pid" \
--dbdir="/var/lib/g7ctrl" --datadir="/usr/share/g7ctrl"</screen>
            </para>
        </refsect1>
        <refsect1>
            <title>Starting and stopping the server</title>
            <para>While strictly speaking not necessary the server should normally be started by the
                    <literal>root</literal> user. As soon as the server doesn't need
                    <literal>root</literal> privileges it will switch to run as the user specified
                in the configuration file, by default this is the user <emphasis>g7ctrl</emphasis>
                if the configuration file has not been changed. This user should for security
                reasons not be the 'root' user. This user should be a system user without login
                shell. Such a user can normally be created by running the command
                    '<emphasis>useradd</emphasis>'. (If the daemon is installed via the RPM package
                this user will be automatically created).</para>
            <para>If your system supports the command <command>useradd</command> then start by
                changing to root and add the user as so</para>
            <screen>$> useradd -r g7ctrl</screen>
            <para>
                <note>
                    <para>The user created must normally belong to the group
                            <literal>dialout</literal> on most system in order to have access to the
                            <acronym>USB</acronym>-serial device.</para>
                </note>
            </para>
            <para>Then to start the server as root using the settings in the configuration file the
                simplest way is to just call</para>
            <screen>sudo g7ctrl</screen>
            <para>In order to stop the server and allow it to do a clean shutdown the
                    <literal>SIGINT</literal> (or <literal>SIGSTOP</literal>) signal should be sent
                to the process running the server (assuming <command>g7ctrl</command> has been
                started as a daemon). The distribution includes two support scripts to help with
                this. This can of course also be done manually as (and reading the pid number from
                the standard pid-file)</para>
            <para>
                <screen>sudo kill -SIGINT `cat /usr/share/g7ctrl/g7ctrl.pid`</screen>
            </para>
            <para>Please note the "<code>`</code>" backward slashes.</para>
            <para>While testing the server it is also possible to start the daemon as a "normal"
                user. As a test start the daemon from command line for example as</para>
            <para>
                <screen>$g7ctrl -dN -V3 -lstdout</screen>
            </para>
            <para>The commands will start the application on the terminal <code>-dN</code> (not as a
                daemon), with maximum logging (<code>-V3</code>) and print the log file directly to
                the terminal (<code>-lstdout</code>). This is a good way to do the initial testing
                since any problem can usually be quickly seen in the log. Note that when the daemon
                is not started as the root user it can not switch to the daemon user specified in
                the configuration file. </para>
            <para>Once the testing is completed the daemon can be setup to be started at the same
                time as the server. Depending on the system this can done in a few different ways as
                the following two sections show.</para>
            <refsect2>
                <title>For system using old style <filename>init.d</filename></title>
                <para>To start the daemon automatically the installation will install two utility
                    scripts. The first script will be installed in
                        "<filename>/etc/init.d/g7ctrl</filename>" and follows the normal guidelines
                    for a "<filename>init.d</filename>" service start/stopping script according to
                        <acronym>LSB</acronym> (Linux Standard Base). Using this script to start the
                    server is then simply a matter of calling</para>
                <screen>sudo /etc/init.d/g7ctrl start</screen>
                <para>(or its alias <command>rcg7ctrl</command>) is given. The start-up script also
                    supports the "<literal>restart</literal>" and "<literal>status</literal>"
                    options.</para>
                <para>If the server gives the error message : "<emphasis>Server can not be started.
                        See system log</emphasis>" then more information about the details of the
                    problem can be found in the system log, normally
                        <filename>/var/log/messages</filename>. The most common reason for this
                    message is that the daemon is already running. </para>
                <para>To stop the server give the command (as root)</para>
                <screen>sudo /etc/init.d/g7ctrl stop</screen>
                <para>Since the <literal>init.d</literal> system has been abandoned in most modern
                    system the <literal>init.d</literal> scripts will then be automatically
                    redirected to the corresponding <literal>systemd</literal> service. In that case
                    it is better to just use the <literal>systemd</literal> service directly as the
                    following section shows.</para>
            </refsect2>
            <refsect2>
                <title>Using systemd</title>
                <para>If your system makes use of <literal>systemd</literal> then the second utility
                    script will be installed as a <literal>systemd</literal> service. The
                    configuration script will automatically figure out if your system supports this.
                    In this case the daemon can be directly controlled via the usual
                        <command>systemctl</command> command as shown below. See <command>man
                        systemctl</command> for details.</para>
                <para>
                    <screen>sudo systemctl stop g7ctrl.service</screen>
                </para>
                <para>
                    <screen>sudo systemctl start g7ctrl.service</screen>
                </para>
                <para>
                    <note>
                        <para>The <literal>g7ctrl</literal> service needs to first be enabled after
                            the initial installation with</para>
                        <para>
                            <screen>sudo systemctl enable g7ctrl.service</screen>
                        </para>
                    </note>
                </para>
                <para>If your system does not have the command <command>systemctl</command> then it
                    is not using the <literal>systemd</literal> setup.</para>
            </refsect2>
            <refsect2>
                <title>Using upstart</title>
                <para>Newer version of Debian and Ubuntu now uses "<literal>upstart</literal>" to manage
                    daemons. The build system fylly supports this and after the usual "<command>sudo make
                        install</command>" the daemon could be controlled by</para>
                <para>
                    <screen>sudo start g7ctrl
sudo stop g7ctrl
sudo status g7ctrl</screen>
                </para>
                <para>or alternatively by</para>
                <para>
                    <screen>sudo service g7ctrl start
sudo service g7ctrl stop
sudo service g7ctrl status</screen>
                </para>
                <para>
                    <note>
                        <para>The configuration file for upstart is stored in
                                <filename>/etc/init/g7ctrl.conf</filename></para>
                    </note>
                </para>
            </refsect2>            
        </refsect1>
        <refsect1>
            <title>Interfacing with the server</title>
            <para>The primary interface to the server is via a TCP/IP connection to the server
                running '<emphasis>g7ctrl</emphasis>' via a dedicated port (by default 3100). The
                server is controlled via a simple (but efficient) command language which allows
                manipulation of future recordings and various other administrative tasks. All
                commands are extensively described in the section 'Command language' below. </para>
            <para>The preferred way of interacting with the server on the command level is by using
                the supplied utility shell '<application>g7sh</application>'. This supports history
                and full command line editing and is recommended over a plain
                    '<application>telnet</application>' (<application>nc</application> command)or
                connections to the server.</para>
            <para>See the section "Connecting to the server" below for more detailed
                examples.</para>
        </refsect1>
        <refsect1>
            <title>Connecting directly to the server</title>
            <para>By default the best way to communicate with the daemon is to us the
                    <command>g7sh</command> command, see below. But the following information may be
                used for additional troubleshooting.</para>
            <para>We start by describing the direct method that communicates with the daemon
                directly on the command port.  This is for illustrative purpose only and can be a
                quick way to check that the daemon is really running when troubleshooting. For
                normal usage it is recommended to use the <citerefentry>
                    <refentrytitle>g7sh</refentrytitle>
                    <manvolnum>1</manvolnum>
                </citerefentry> utility shell program (seel also next section).</para>
            <para>Once the server is running the easiest way to connect to the command is by using
                the '<emphasis>nc</emphasis>' ('net cat) program. Assuming that the
                    <emphasis>g7ctrl</emphasis> server is running on the localhost the following
                command will connect to the server (assuming the default port 3100 has not been
                changed (either in the configuration file (e.g.
                    <filename>/etc/g7ctrl.conf</filename>) or by a command line argument).</para>            
                <screen>$> nc localhost 3100</screen>            
            <para>After a successful connection the server will reply with a short, one line,
                information message. The full returned information message at the connection time
                should look something similar to the following (the version and build might be
                different though):</para>
            <screen>GM7 Server version 3.0.0 (build 150108-110)
</screen>
            <para>If password protection (see section "Security" below) the welcome message is not
                be shown until the correct password has been specified. Instead when password
                protection is enabled the connection sequence looks like this</para>
            
                <screen>$> nc localhost 3100
Password:<emphasis role="bold">xxxxxxx</emphasis>
GM7 Server version 3.0.0 (build 150108-110)
</screen>
            
            <para>This means that the correct server password has to be given before the welcome
                message is seen. The server is now ready to accept commands on this
                connection.</para>
            <para>To disconnect to the server give the command '<command>exit</command>'</para>
        </refsect1>
        <refsect1>
            <title>Using the g7sh to connect to the daemon</title>
            <para>The package also includes a full command line shell, <command>g7sh</command>. This
                allows much better editing (Emacs compatible editing) as well as full command line
                history. This shell can also be used as a system login shell and hereby making it
                possible to connect to the daemon using <command>ssh</command> for a more secure
                communication by creating a unique user with g7sh as the login shell.</para>
            <para>How to setup and use the g7sh command line shell is fully described in <citerefentry>
                    <refentrytitle>g7sh</refentrytitle>
                    <manvolnum>1</manvolnum>
                </citerefentry></para>
            <para>In its simplest form (assuming it is the same sever as the daemon) the shell can
                be started with</para>
            <para>
                <screen>$ g7sh</screen>
            </para>
            <para>Run <command>g7sh -h</command> for a list of supported options.</para>
        </refsect1>
        <refsect1>
            <title>Directory structure</title>
            <para>The daemon uses two distinct directories on the server; one data directory where
                the database and log files are stored and one configuration directory. The default
                location of these directories are specified at build but may be overridden by either
                the configuration file or by command line arguments. The package default locations
                are shown below</para>
            <para>
                <variablelist>
                    <varlistentry>
                        <term><filename>/etc/g7ctrl</filename></term>
                        <listitem>
                            <para>Configurations file.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><filename>/usr/share/g7ctrl</filename></term>
                        <listitem>
                            <para>This is the data directory where static data files (like mail
                                templates and presets) are stored.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><filename>/var/lib/g7ctrl</filename></term>
                        <listitem>
                            <para>This is the data directory where dynamic data files (like DB) are
                                stored.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </para>
        </refsect1>
        <refsect1>
            <title>Security</title>
            <para>In order to prevent unauthorized access to the server the server have a basic
                password protection. This means that a password can be configured to be used before
                a client can start giving command to the server. This is configured in the ini-file.
                The configuration uses the same password for all clients so the server does not
                support multiple users/multiple password. Since the password is stored in plain text
                format the configuration file should have restricted access. This should not be
                considered strong security but rather a weak "stop-messing-with-daemon" type of
                protection.</para>
            <para>Sine the password are sent unencrypted to the daemon it is also susceptible to
                line snooping.</para>
            <para>The setting whether password should be used or not and the actual password is
                specified in the ini-file. </para>
            <para>After connecting to the server when the password has been enabled the first string
                sent back from the server will be the single string:</para>
            
                <screen>Password:</screen>
            <para>The rest of the reply is the same as when no password is used.</para>
            <para>If security is of concern the daemon can also be configured to only allow
                connections from the localhost, i.e. connections must be made from the same machine
                that is running the daemon. This is done by enabling the option
                    "<literal>only_localhost</literal>" in the config file.</para>
            
        </refsect1>
        <refsect1>
            <title>Managing notifications mails</title>
            <para>When configuring the daemon it is possible to set options that will send
                notification mails on important events in the daemon. This could be notifications on
                errors that occurred but also notifications on that a transcoding was finished or
                that the server was shutdown automatically while waiting for the next
                recording.</para>
            <para>All mail settings are specified in the "<code>[mail]</code>" section of the
                configuration file. More information is available in the full application
                manual.</para>
        </refsect1>
        <refsect1>
            <title>Commands (in alphabetic order)</title>
            <para>The following is a list and detailed explanation of the commands that are
                recognized by the server. </para>
            <para>Since there are quite a few commands we start with an overview with a one line
                explanation of each command. Further details can be found below</para>
            
  <para>There commands are divided into three different areas</para>
    <para>
        <orderedlist>
            <listitem>
                <para>Device commands. They are commands that controls a connected device</para>
            </listitem>
            <listitem>
                <para>Database commands. Commands to export and read the database</para>
            </listitem>
            <listitem>
                <para>Preset commands. Commands to manipulate presets</para>
            </listitem>
            <listitem>
                <para>Daemon commands.  Commands to act on the daemon itself.</para>
            </listitem>
        </orderedlist>
    </para>
     <refsect2>   
        <title>Device Command reference</title>
        <para>Below is the commands possible together with there parameters. In case a command can
            accept argument the daemon will ask for each command in sequence. The prompt will always be
            indicated by a "<literal>?</literal>" mark. To abort a specific command just type a single
            dot "<literal>.</literal>" and the command shell will return to the start position (outer
            level). Most commands only accept a selected value chosen from a list. All possible values
            in the lists are shown below.</para>
        <para>For even more detailed command information please refer to the "<emphasis role="italic"
                >GM7 Protocol specification</emphasis>" available from where you purchased your
            device.</para>
                <variablelist>
                    <varlistentry>
                        <term><emphasis role="bold">address</emphasis></term>
                        <listitem>
                            <para>Return the current location as an approximate street
                                address</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.clrec">
                        <term><emphasis role="bold">clrec</emphasis></term>
                        <listitem>
                            <para>Erase all recorded locations in device memory. Use
                                    <literal>dlrec</literal> to read back the recorded location
                                positions in device memory to the database.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="comm">
                        <term><emphasis role="bold">comm</emphasis></term>
                        <listitem>
                            <para>Set/Read device communication type and its parameters</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>CommSelect</emphasis> - Select primary type of
                                            communication </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "Use USB" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Use SMS over GSM"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "CSD (reserved)"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>3</parameter> - "UDP over GPRS" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>4</parameter> - "TCP/IP over GPRS"
                                                  </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>SMS Base Phone</emphasis> - SMS base number to
                                            call </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>CSD Base Phone</emphasis> - CSD base number
                                            (reserved and not used) </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>GPRS APN</emphasis> - The operators APN
                                        </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>GPRS User</emphasis> - User name if required
                                        </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>GPRS Passwd</emphasis> - Password if required
                                        </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>GPRS Server</emphasis> - Server IP address
                                            where the device reports back to </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>GPRS Server Port</emphasis> - TCP/IP Port to
                                            use on server </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>GPRS Keep Alive</emphasis> - Interval (in sec)
                                            between Keep Alive Packets </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>GPRS DNS</emphasis> - Optional DNS server for
                                            device to use. </para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.config">
                        <term><emphasis role="bold">config</emphasis></term>
                        <listitem>
                            <para>Set/Read device ID, Password, and PIN Code of the SIM card</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>Device ID</emphasis> - Set device ID (leftmost
                                            digit must always be 3) </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Device Password</emphasis> - Set device
                                            Password (numeric) </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>SIM Card PIN</emphasis> - The SIM cards PIN
                                            code to use </para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.dlrec">
                        <term><emphasis role="bold">dlrec</emphasis></term>
                        <listitem>
                            <para>Download all recorded position in device memory to the database.
                                Positions that have been downloaded from the device memory in this
                                way will have an event id of <literal>1</literal>. </para>
                            <para>
                                <note>
                                    <para>Please note that download and DB update takes a bit of
                                        time. As an example download and DB updated of 10,000
                                        locations took 17s in one instance. The bulk of the time,
                                        ~95%, is spent downloading the data from the device over the
                                        serial line and ~5% was spent to update the DB with the new
                                        locations.</para>
                                </note>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.geofevt">
                        <term><emphasis role="bold">geofevt</emphasis></term>
                        <listitem>
                            <para>Enable/Disable/Set/Read GEO-Fencing event</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>Event ID</emphasis> - Event ID. Maximum of 50
                                            events. In range 50-99 </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Enabled</emphasis> - Enable/Disable event </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Longitude</emphasis> - Longitude for center of
                                            event zone </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Latitude</emphasis> - Latitude for center of
                                            event zone </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Radius</emphasis> - Radius of event zone in
                                            meters (0-65535) </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>ZoneControl</emphasis> - How to trigger event </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Entering zone" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "Leaving zone" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Action</emphasis> - What to do on event </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Log to device" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "Send to server"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>3</parameter> - "Both log and send"
                                                  </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.gfen">
                        <term><emphasis role="bold">gfen</emphasis></term>
                        <listitem>
                            <para>Enable/Disabling GEO-fencing functionality</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>Enabled</emphasis> - Turn option on/off
                                        </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Radius</emphasis> - Radius in meter for fence
                                        </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Zone trigger</emphasis> - Trigger when leaving
                                            or entering zone </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Inside zone" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "Outside zone" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Report action</emphasis> - What to do on event </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "Disabled" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Log to device" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "Send to server"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>3</parameter> - "Both log and send"
                                                  </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>VIP mask</emphasis> - Bitmask of VIP numbers
                                            to alert </para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.imei">
                        <term><emphasis role="bold">imei</emphasis></term>
                        <listitem>
                            <para>Query the IMEI number of the internal GSM module</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.led">
                        <term><emphasis role="bold">led</emphasis></term>
                        <listitem>
                            <para>Enable/Disable the LED indicator on/off</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.loc">
                        <term><emphasis role="bold">loc</emphasis></term>
                        <listitem>
                            <para>Get latest location</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><emphasis role="bold">locg</emphasis></term>
                        <listitem>
                            <para>Get the latest position as a Google map link</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.lowbatt">
                        <term><emphasis role="bold">lowbatt</emphasis></term>
                        <listitem>
                            <para>Set/Read the internal battery low level alert</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>Report action</emphasis> - Action to perform
                                            at low battery voltage </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "Disable" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Log on device" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "Send back to server"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>3</parameter> - "Both log and send back
                                                  ro server" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>VIP mask</emphasis> - Bit-mask of VIP numbers
                                            to alert </para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.mswitch">
                        <term><emphasis role="bold">mswitch</emphasis></term>
                        <listitem>
                            <para>Enable/Disable detached report</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.nrec">
                        <term><emphasis role="bold">nrec</emphasis></term>
                        <listitem>
                            <para>Return date range and number of location records stored in device
                                memory</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.phone">
                        <term><emphasis role="bold">phone</emphasis></term>
                        <listitem>
                            <para>Enable the function "Get the current location by making a phone
                                call"</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.ps">
                        <term><emphasis role="bold">ps</emphasis></term>
                        <listitem>
                            <para>Enable/Disable power saving mode</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>Mode</emphasis> - Select when to enable sleep
                                            mode to save battery </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "Sleep after 3min of no
                                                  movement. Wake up on movements. GSM=Standby,
                                                  GPRS=GPS=Off, G-sensor=On" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Always enter sleep
                                                  after 3min and wake every n seconds specified.
                                                  GSM=GPRS=GPS=G-sensor=Off" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "Always enter sleep
                                                  after 3min and wake up on timer.
                                                  GSM=GPRS=GPS=G-sensor=Off" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>3</parameter> - "Always enter sleep
                                                  after 3min and wake up on movement.
                                                  GSM=GPRS=GPS=Off, G-sensor=On" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Sleep interval</emphasis> - Used with sleep
                                            mode 1, Interval in minutes between wake-ups </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Wake up report</emphasis> - Action when awaken </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "Disable" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Log on device" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "Send back to server"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>3</parameter> - "Both log and send back
                                                  ro server" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>VIP mask</emphasis> - Bit-mask of VIP numbers
                                            to alert on awake </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Timer 1</emphasis> - Used with mode=2. 00-23
                                            hr </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Timer 2</emphasis> - Used with mode=2. 00-23
                                            hr </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Timer 3</emphasis> - Used with mode=2. 00-23
                                            hr </para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.reboot">
                        <term><emphasis role="bold">reboot</emphasis></term>
                        <listitem>
                            <para>Restart-up the device</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.rec">
                        <term><emphasis role="bold">rec</emphasis></term>
                        <listitem>
                            <para>Enable/Disable/read logging function to the device</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>Mode</emphasis> - When should logging be done </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "Disable" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Time mode, log every n
                                                  seconds" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "Distance mode, log
                                                  every n meters" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>3</parameter> - "Time AND Distance
                                                  mode" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>4</parameter> - "Time OR Distance mode"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>5</parameter> - "Heading mode, logging
                                                  starts when heading > set value" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>6</parameter> - "Heading OR Time mode"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>7</parameter> - "Heading OR Distance"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>8</parameter> - "Heading OR (Time AND
                                                  Distance)" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>9</parameter> - "Heading OR Time OR
                                                  Distance" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Time interval</emphasis> - Time interval (in
                                            sec) used in mode setting </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Distance interval</emphasis> - Distance
                                            interval (in meters) used in mode setting </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Number of reports</emphasis> - The number of
                                            reports to send back on event (0=continuous logging) </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Record basis</emphasis> - Logging mode </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "Wait for GPS fix
                                                  before sending back report" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Don't wait for GPS fix
                                                  before sending back report" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Heading</emphasis> - Heading value used in
                                            mode (10-90) </para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.reset">
                        <term><emphasis role="bold">reset</emphasis></term>
                        <listitem>
                            <para>Reset all parameters to the manufacture default settings</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.roam">
                        <term><emphasis role="bold">roam</emphasis></term>
                        <listitem>
                            <para>Enable/Disable GPRS roaming function</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.sim">
                        <term><emphasis role="bold">sim</emphasis></term>
                        <listitem>
                            <para>Query the identification of the SIM card</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.sleep">
                        <term><emphasis role="bold">sleep</emphasis></term>
                        <listitem>
                            <para>Enable/Disable "Sleeping Report"</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>Message mode</emphasis> - Set how to handle
                                            message at when device enters sleep </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "log message to device"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "send back message"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>3</parameter> - "both log and send back
                                                  message" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.sms">
                        <term><emphasis role="bold">sms</emphasis></term>
                        <listitem>
                            <para>Switch the SMS format (Text of PDU mode)</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>Mode</emphasis> - Set format for SMS sent back </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "Use PDU mode" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Use text mode" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.stopdl">
                        <term><emphasis role="bold">stopdl</emphasis></term>
                        <listitem>
                            <para>Stop downloading logging data from the device</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term><emphasis role="bold">test</emphasis></term>
                        <listitem>
                            <para>Device diagnostic function</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.track">
                        <term><emphasis role="bold">track</emphasis></term>
                        <listitem>
                            <para>Control if device should be sending back automatic tracking
                                information.</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>Tracking mode</emphasis> - Set condition for
                                            when tracking is started </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Time mode" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "Distance mode" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>3</parameter> - "Time AND Distance
                                                  mode" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>4</parameter> - "Time OR distance"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>5</parameter> - "Heading mode" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>6</parameter> - "Heading OR time"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>7</parameter> - "Heading OR distance"
                                                  </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>8</parameter> - "Heading OR (Time AND
                                                  Distance" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>9</parameter> - "Heading OR Time OR
                                                  Distance" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Timer interval</emphasis> - Used for mode 1
                                        </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Distance interval</emphasis> - Used for mode
                                            2-9 </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Number of tracking</emphasis> - Use 0 for
                                            continuous tracking </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Track basis</emphasis> - Wait for GPS fix or
                                            not </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "Send report ONLY if
                                                  GPS is fixed" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Send report regardless
                                                  of GPS status" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Comm select</emphasis> - Set type of report </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "Over USB" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>1</parameter> - "Over GSM" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>2</parameter> - "Over Reserved (not
                                                  used)" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>3</parameter> - "UDP over GPRS" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>4</parameter> - "TCP/IP over GPRS"
                                                  </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Heading</emphasis> - Used for modes 5-9
                                        </para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.tz">
                        <term><emphasis role="bold">tz</emphasis></term>
                        <listitem>
                            <para>Set the time zone information for the device</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>Sign</emphasis> - Ahead or before GMT zone </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>+</parameter> - "Ahead of GMT" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>-</parameter> - "Before GMT" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Hour</emphasis> - Number of hours to adjust
                                            (0-9) </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>Min</emphasis> - Minutes to adjust </para>
                                        <para>Possible values and description:<itemizedlist>
                                                <listitem>
                                                  <para>
                                                  <parameter>0</parameter> - "0 min" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>15</parameter> - "15 min" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>30</parameter> - "30 min" </para>
                                                </listitem>
                                                <listitem>
                                                  <para>
                                                  <parameter>45</parameter> - "45 min" </para>
                                                </listitem>
                                            </itemizedlist></para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.ver">
                        <term><emphasis role="bold">ver</emphasis></term>
                        <listitem>
                            <para>Get current firmware version</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry xml:id="cmd.vip">
                        <term><emphasis role="bold">vip</emphasis></term>
                        <listitem>
                            <para>Preset up to 5 SMS phone numbers for receiving different
                                alerts</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para>
                                            <emphasis>VIP 1</emphasis> - Mobile number 1 (full
                                            number incl country prefix '+' if needed) </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>VIP 2</emphasis> - Mobile number 2 (full
                                            number incl country prefix '+' if needed) </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>VIP 3</emphasis> - Mobile number 3 (full
                                            number incl country prefix '+' if needed) </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>VIP 4</emphasis> - Mobile number 4 (full
                                            number incl country prefix '+' if needed) </para>
                                    </listitem>
                                    <listitem>
                                        <para>
                                            <emphasis>VIP 5</emphasis> - Mobile number 5 (full
                                            number incl country prefix '+' if needed) </para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                </variablelist>
    </refsect2>
     <refsect2>
            <title>Database commands</title>
            <para>The database commands are used to manage the stored location updates from the
                devices.</para>
           
            <variablelist>
                    <varlistentry xml:id="cmd.db-dist" xreflabel="Command: db dist">
                        <term><literal>db dist [dev=nnn] [ev=nnn] [from to]</literal></term>
                        <listitem>
                            <para>Calculate the <emphasis role="bold"><emphasis role="underline"
                                        >approximate distance</emphasis></emphasis> traveled using
                                the selected data set of location points.</para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para><literal>[dev=nnn]</literal> - Filter on a specific
                                            device-id. If not set all devices will be
                                            considered.</para>
                                    </listitem>
                                    <listitem>
                                        <para><literal>[ev=nnn]</literal> - Filter on specific
                                            event. If not set all events will be considered.</para>
                                    </listitem>
                                    <listitem>
                                        <para><literal>[from to]</literal> - Filter on a specific
                                            date range. Dates are given in
                                                <literal>YYYY-MM-DD</literal> format with optional
                                            time specification as <literal>HH:MM</literal> in 24h
                                            format (military time). If omitted all dates are
                                            considered.</para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                            <para>Calculation of distance is approximation of the distance between
                                two <acronym>GPS</acronym> points (assuming WGS-84 projection) and
                                returns the result using both the <emphasis role="italic"
                                    >Haversine</emphasis> method (great circle distance) and
                                    <emphasis role="italic">Vincenty</emphasis> method (iterative).
                                The reply from the daemon is given as two lines exemplified
                                by</para>
                            <para>
                                <screen>Calculating approximate distance using 344 points.
25.3 km (alt. 25399.5 m)</screen>
                            </para>
                            <para>The second distance in <literal>m</literal> are calculated using
                                the <emphasis role="italic">Vincenty</emphasis> method and the first
                                distance (in <literal>km</literal>) is calculated using the
                                    <emphasis role="italic">Haversine</emphasis> method.</para>
                            <para>Due to the number of error sources in getting location updates and
                                limitations inherent in this type of distance calculations <emphasis
                                    role="bold">we can not in general assume to have perfect
                                    accuracy</emphasis>. The accuracy will also vary depending on
                                the absolute location due to differences in the earth radius. The
                                way traveled between recorded positions is assumed to follow the
                                great circle between the points so the more points the better
                                approximation of the actual real distance. </para>
                            <para>
                                <note>
                                    <para>The precise volatility in the distance figures are very
                                        difficult to quantify due to the large number of factors
                                        that influence the <acronym>GPS</acronym> signal and the way
                                        the distance can be calculated. However,practical tests
                                        (with the GM7 device) have shown that in general it is safe
                                        to assume that the true distance (as measured in the middle
                                        part of Sweden around lat 57&#xb0;) in more than 80% of the
                                        cases have less than 5% error compared with the distance as
                                        measured by an odometer. If more accuracy is needed in a
                                        particular area then field tests with known distances needs
                                        to be performed and correction factors introduced.</para>
                                    <para>Often the distance is slightly underestimated and the
                                        longer time interval between each measure the more the
                                        distance is underestimated. This is due to the fact that the
                                        distance travelled between each measured point is assumed to
                                        be the shortest (great circle) distance and in practice the
                                        real distance is always longer.</para>
                                    <para>(The <emphasis role="italic">Vincenity</emphasis> method
                                        will generally have better accuracy assuming perfect
                                            <acronym>GPS</acronym> positions. )</para>
                                </note>
                            </para>
                            <para><emphasis role="bold"> Examples: </emphasis></para>
                            <para>
                                <itemizedlist>
                                    <listitem>
                                        <para><literal>db dist</literal></para>
                                        <para>Use all the data points and calculate the total
                                            traveled distance</para>
                                    </listitem>
                                    <listitem>
                                        <para><literal>db dist ev=1 2013-08-01
                                            2013-08-01</literal></para>
                                        <para>Calculate the traveled distance from the previously
                                            imported data points from the internal memory of the
                                            device (they will have eventid=1) for the 1:st of August
                                            2013.</para>
                                    </listitem>
                                    <listitem>
                                        <para><literal>db dist 2013-01-01 2013-12-31
                                            13:00</literal></para>
                                        <para>Calculate the total distance in DB for 2013 regardless
                                            of what event triggered the location update</para>
                                    </listitem>
                                </itemizedlist>
                            </para>
                        </listitem>
                    </varlistentry>
                <varlistentry>
                    <term>db export [dev=nnn] [ev=nnn] [from to] (gpx|kml|xml|csv|json)
                            [filename]</term>
                    <listitem>
                        <para>Exports the database in the selected format</para>
                        <para>
                            <itemizedlist>
                                <listitem>
                                    <para><literal>[dev=nnn]</literal> - Filter on a specific device
                                            id. If not set all devices will be considered.</para>
                                </listitem>
                                <listitem>
                                    <para><literal>[ev=nnn]</literal> - Filter on specific event. If
                                            not set all events will be considered.</para>
                                </listitem>
                                <listitem>
                                    <para><literal>[from to]</literal> - Filter on a specific date
                                        range. Dates are given in YYYY-MM-DD format. If omitted all
                                        dates are considered.</para>
                                </listitem>
                                <listitem>
                                    <para><literal>(gpx|kml|xml|csv|json)</literal> - Export format
                                            to use</para>
                                </listitem>
                                <listitem>
                                    <para><literal>[filename]</literal> - Full filename path to
                                            export to. If omitted the data will be exported to
                                                <filename>/var/lib/g7ctrl/export.&lt;format></filename>
                                        </para>
                                </listitem>
                            </itemizedlist>
                        </para>
                        <para><emphasis role="bold">
                            Examples:
                        </emphasis></para>
                        <para>
                            <itemizedlist>
                                <listitem>
                                    <para><literal>db export gpx</literal></para>
                                    <para>Export all stored location in GPX format to
                                                <filename>/var/lib/g7ctrl/export.gpx</filename></para>
                                </listitem>
                                <listitem>
                                    <para><literal>db export dev=3000000001 2013-02-01 2013-02-28 xml
                                            /tmp/myexport.xml</literal></para>
                                    <para>Export all location reported in February for device
                                            <literal>3000000001</literal> in g7ctgrl own <acronym>XML</acronym> format to
                                        the file <filename>/tmp/myexport.xml</filename></para>
                                </listitem>
                            </itemizedlist>
                        </para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>db lastloc</term>
                    <listitem>
                        <para>Display the latest recorded position</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>db mailpos</term>
                    <listitem>
                        <para>Mail the last recorded position</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term>db mailgpx</term>
                    <listitem>
                        <para>Mail a compressed version of a GPX export of the entire DB to the
                                predefined mail address.</para>
                    </listitem>
                </varlistentry>
                    <varlistentry>
                        <term>db mailcsv</term>
                        <listitem>
                            <para>Mail a compressed version of a CSV export of the entire DB to the
                                predefined mail address.</para>
                        </listitem>
                    </varlistentry>
            </variablelist>
        </refsect2>
     <refsect2>
            <title>Preset commands</title>
            <para>The preset commands are used to manage the stored commands in the presets</para>
            <variablelist>
                <varlistentry>
                    <term><literal>preset list</literal></term>
                    <listitem>
                        <para>List all define presets</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><literal>preset refresh</literal></term>
                    <listitem>
                        <para>Re-read all presets from disk</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><literal>preset use &lt;preset-name></literal></term>
                    <listitem>
                        <para>Execute the specified preset. A shortcut for this is
                                "<literal>@&lt;preset-name></literal>"</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><literal>preset help &lt;preset-name></literal></term>
                    <listitem>
                        <para>Print help for the specified preset</para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </refsect2>
            <refsect2>
                <title>Daemon commands</title>
                <para>Daemon commands are internal commands to work with the daemon itself.</para>
                <variablelist>
                    <varlistentry>
                        <term>.ver</term>
                        <listitem>
                            <para>Display the version of the daemon</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>.dev</term>
                        <listitem>
                            <para>Show if the device is connected or not</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>.lc</term>
                        <listitem>
                            <para>List active command connections</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>.ld</term>
                        <listitem>
                            <para>List all connected devices, both over GPRS and on USB</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>.target &lt;dev></term>
                        <listitem>
                            <para>List or set device connected over GPRS to receive commands</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>.usb &lt;dev></term>
                        <listitem>
                            <para>List or set device connected on USB to receive commands</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>.nick</term>
                        <listitem>
                            <para>Specify a new nick name for device</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>.ln</term>
                        <listitem>
                            <para>List all defined nick names</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>.dn</term>
                        <listitem>
                            <para>Delete the specified nick</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </refsect2>    
            
            
        </refsect1>
        <refsect1
            xml:id="g7ctrl.files">
            <title>Files</title>
            <para>Note: The system configuration directory to be used is a compile time settings and
                specified with the '<emphasis>configuration</emphasis>' argument '--sysconfdir'. </para>
            <variablelist>
                <varlistentry>
                    <term><filename>/var/log/g7ctrl/g7ctrl.log</filename></term>
                    <listitem>
                        <para>The logfile. The log-directory is specified in the ini-file. It can
                            also be specified as a command line argument (<option>-l,
                                --logfile</option>) which will then override any config file
                            setting. By default the log file will be stored under
                                <filename>/var/log/g7ctrl/g7ctrl.log</filename>.</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><filename>/var/run/g7ctrl/g7ctrl.pid</filename></term>
                    <listitem>
                        <para>The pid of the started 'g7ctrl' server. This is used to easily find
                            the pid in order to shutdown the server. This is used by the
                                <emphasis>stop-g7ctrl</emphasis> script. Note that in order to use
                            this directory the daemon has to be started by the root user. </para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><filename>/etc/g7ctrl/g7ctrl.conf</filename></term>
                    <listitem>
                        <para>Default configuration file</para>
                    </listitem>
                </varlistentry>
                <varlistentry>
                    <term><filename>/var/lib/g7ctrl/gm7tracker_db.sqlite3</filename></term>
                    <listitem>
                        <para>The sqlite3 database where all locations are stored.. </para>
                    </listitem>
                </varlistentry>
            </variablelist>
        </refsect1>
        <refsect1>
            <title>Limitations</title>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>All information, error messages and loggings are hard coded in
                            English.</para>
                    </listitem>
                </itemizedlist>
            </para>
        </refsect1>
        <refsect1>
            <title>Bugs</title>
            <itemizedlist>
                <listitem>
                    <para>The configuration file has too many settings. </para>
                </listitem>
            </itemizedlist>
        </refsect1>
        <refsect1>
            <title>Notes</title>
            <para>Any errors that are discovered in the start-up phase before a logfile has been
                established will be written to the default system log (normally
                    <filename>/var/log/messages</filename> or <filename>/var/log/syslog</filename>) </para>
        </refsect1>
        <refsect1>
            <title>Resources</title>
            <para>
                <itemizedlist>
                    <listitem>
                        <para>SourceForge:
                            &lt;<uri>http://sourceforge.net/projects/g7ctrl/</uri>></para>
                    </listitem>
                </itemizedlist>
            </para>
        </refsect1>
        <refsect1>
            <title>Author</title>
            <para>Written and maintained by Johan Persson
                &lt;<email>johan162@gmail.com</email>></para>
        </refsect1>
        <refsect1>
            <title>Copyright</title>
            <para>Free use of this software is granted under the terms of the <acronym>GNU</acronym> General Public
                License (GPL v3), see the file <filename>COPYING</filename> included in the
                distribution archive for details.</para>
        </refsect1>
        <refsect1
            xml:id="g7ctrl.seealso">
            <title>See also</title>
            <para><citerefentry>
                    <refentrytitle>g7sh</refentrytitle>
                    <manvolnum>1</manvolnum>
                </citerefentry></para>
        </refsect1>
    </refentry>
</article>
